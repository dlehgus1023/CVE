# CVE-2021-2086

# Oracle Critical Patch Update Advisory - January 2021

## Same CVE Credit 
- ChenNan And Kun Yang Of Chaitin Security Research Lab

- Xingwei Lin And Gaoning Pan (Zhejiang University) of Ant Security Light-Year Lab

- DoHyun Lee of VirtualBoBs

### VirtualBox Divide By Zero (Denial of Service) Vulnerability

Product : VirtualBox 6.1.16

HOST OS : ubuntu 20.04

GEST OS : ubutnu 20.04

TODO: sudo ./poc

```
[New Thread 0x7fb2c81fe700 (LWP 10915)]

Thread 17 "EMT-1" received signal SIGFPE, Arithmetic exception.
[Switching to Thread 0x7fb331104700 (LWP 10687)]
0x00007fb3121d05ee in ataR3SetSector (s=0x7fb310124440, iLBA=18446744073709551615) at /home/leedohyun/VirtualBox-6.1.16/src/VBox/Devices/Storage/DevATA.cpp:1671
1671	        cyl = iLBA / (s->PCHSGeometry.cHeads * s->PCHSGeometry.cSectors);
LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA
────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────
 RAX  0xffffffffffffffff
 RBX  0x1
 RCX  0x20
 RDX  0x0
 RDI  0x7fb310124440 ◂— 0x5e010600
 RSI  0x0
 R8   0x0
 R9   0x7fb310124440 ◂— 0x5e010600
 R10  0x7fb310021440 ◂— 0x0
 R11  0x7fb310124440 ◂— 0x5e010600
 R12  0x7fb310021000 ◂— 0xff820040 /* '@' */
 R13  0x0
 R14  0x0
 R15  0x7fb310226448 ◂— 0x19790326
 RBP  0x7fb331103a30 —▸ 0x7fb331103a90 —▸ 0x7fb331103ac0 —▸ 0x7fb331103af0 —▸ 0x7fb331103b30 ◂— ...
 RSP  0x7fb3311039a8 —▸ 0x7fb3121d5665 ◂— mov    r10, qword ptr [rbp - 0x60]
 RIP  0x7fb3121d05ee ◂— div    r8
─────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────
   0x7fb3121d05d8    mov    esi, dword ptr [rdi + 0x8000c]
   0x7fb3121d05de    xor    edx, edx
   0x7fb3121d05e0    and    ecx, 0xfffffff0
   0x7fb3121d05e3    mov    r8d, esi
   0x7fb3121d05e6    imul   r8d, dword ptr [rdi + 0x80008]
 ► 0x7fb3121d05ee    div    r8
    ↓
   0x7fb3121d05ee    div    r8



──────────────────────────────────────────[ SOURCE (CODE) ]──────────────────────────────────────────
In file: /home/leedohyun/VirtualBox-6.1.16/src/VBox/Devices/Storage/DevATA.cpp
   1666         }
   1667     }
   1668     else
   1669     {
   1670         /* CHS */
 ► 1671         cyl = iLBA / (s->PCHSGeometry.cHeads * s->PCHSGeometry.cSectors);
   1672         r = iLBA % (s->PCHSGeometry.cHeads * s->PCHSGeometry.cSectors);
   1673         s->uATARegHCyl = cyl >> 8;
   1674         s->uATARegLCyl = cyl;
   1675         s->uATARegSelect = (s->uATARegSelect & 0xf0) | ((r / s->PCHSGeometry.cSectors) & 0x0f);
   1676         s->uATARegSector = (r % s->PCHSGeometry.cSectors) + 1;
──────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────
00:0000│ rsp  0x7fb3311039a8 —▸ 0x7fb3121d5665 ◂— mov    r10, qword ptr [rbp - 0x60]
01:0008│      0x7fb3311039b0 —▸ 0x7fb3302f5db0 ◂— 0x5c39971377
02:0010│      0x7fb3311039b8 ◂— 0x80c2f107ed346d00
03:0018│      0x7fb3311039c0 —▸ 0x7fb310124440 ◂— 0x5e010600
04:0020│      0x7fb3311039c8 ◂— 0x103000
05:0028│      0x7fb3311039d0 —▸ 0x7fb310021440 ◂— 0x0
06:0030│      0x7fb3311039d8 —▸ 0x7fb310124440 ◂— 0x5e010600
07:0038│      0x7fb3311039e0 —▸ 0x7fb35c043000 ◂— 0x0
────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────
 ► f 0     7fb3121d05ee
   f 1     7fb3121d5665
   f 2     7fb3121d5665
   f 3     7fb3121d5665
   f 4     7fb35c24df68 IOMIOPortWrite+328
   f 5     7fb35c144f9a IOMR3ProcessForceFlag+250
   f 6     7fb35c13b2cd emR3HighPriorityPostForcedActions+253
   f 7     7fb35c13edfa emR3HmExecute+186
─────────────────────────────────────────────────────────────────────────────────────────────────────
```

---
